---
title:  "첫번째 팀 프로젝트 - 책 판매 페이지 페이지"
excerpt: "아동용 책판매 쇼핑몰 - 책 판매 페이지"

categories:
  - team preject
tags:
  - java
  - spring
  - jsp
  - MySQL
last_modified_at: 2023-08-25 19:23PM
---
<div style = "font-size : 15px; margin-bottom: 10px;"><span style="font-weight: bold;">개발 기간</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:gray"> 2023-07 ~ 2023-09(3개월)</span></div>

<div style = "font-size : 15px; margin-bottom: 10px;"><span style="font-weight: bold;">플랫폼</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:gray">Web</span></div>

<div style = "font-size : 15px; margin-bottom: 10px;"><span style="font-weight: bold;">개발인원</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:gray">3명(팀장)</span></div>

<div style = "font-size : 15px; margin-bottom: 10px;"><span style="font-weight: bold;">담당 역할</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:gray"> 책 판매 페이지 개발(기여도 90%) 프론트엔드-jsp(기여도 80%)</span></div>

<div style = "font-size : 15px; margin-bottom: 10px;"><span style="font-weight: bold; ">전체 코드&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="https://github.com/kwonyeongdae/portfolio/tree/main/Book" style="text-decoration: none;"> github 보러가기</a></div>
-----------------------------------------------------------------------------
<h3>프로젝트</h3>

- 추가기능

<div style="font-size : 17px; color:bule; margin-bottom: 7px">BookVO</div>
```java
@Component("book")
//메인화면에 올릴 책 표지를 위해 사진파일을 첨부할수 있게 만듬
public class BookVO {
	private int bnum;
	private String bname;
	private float fsize;
	private  String contenttype;
    	private String publisher;
	private String author;
	private int price;
	private String pdate;
	private String content;
	private String cvrimg;
	private String cate;
	private List<Bookattach> flist;
}
//book의 상세페이지에 첨부할 사진을 위한 컬럼들
public class Bookattach {

	private int num;
	private int bnum;
	private String contentimg;
	private float consize;
	private String contype;
}
```
<div style = "font-size : 15px; margin-bottom: 7px">
1. 책 등록에  필요한 8개의 컬럼과 상품상세보기에 사진을 추가하기위해 List로Bookattach 클래스를 받아왔습니다.</div>
<div style = "font-size : 15px; margin-bottom: 15px">
2. cate는 책을 카테고리 별로 나누기 위한 컬럼입니다.</div>

<div style="font-size : 17px; color:bule; margin-bottom: 7px">BookMapper.xml</div>
```html
<!--책 추가 로직입니다 -->
<insert id="addbook" parameterType="com.ezen.spring.board.teampro.book.Book">
<selectKey keyProperty="bnum" resultType="int" order="AFTER">
	      SELECT LAST_INSERT_ID()
	   	</selectKey>
INSERT INTO book
VALUES(NULL,#{bname},#{publisher},#{author},#{price},#{pdate}, #{content}, #{cvrimg},#{cate},#{fsize},#{contenttype})
</insert>
<!--책 상세보기에 올릴 사진을 위한 추가로직입니다. -->
<insert id="addfile" parameterType="com.ezen.spring.board.teampro.book.Bookattach">
   	  INSERT INTO bookattach (num, bnum, contentimg, consize, contype) VALUES
      <foreach collection="list" item="item" separator=", ">
           ( NULL, #{item.bnum}, #{item.contentimg}, #{item.consize}, #{item.contype} )
      </foreach>
  </insert>
```
<div style = "font-size : 15px; margin-bottom: 15px">
1. 문의사항 추가 로직과 매우 유사합니다.</div>


<div style="font-size : 17px; color:bule; margin-bottom: 7px">BookDAO</div>
```java
public class BookDAO {
	@Autowired
	@Qualifier("bookmapper")
	private BookMapper bookmap;
	
	public boolean addbooks(Book bo) {
	   boolean bSaved = bookmap.addbook(bo)>0;
		
	   int bnum = bo.getBnum();
	   List<Bookattach> list = bo.getFlist();
	   if (list != null && !list.isEmpty()) {
	       for (int i = 0; i < list.size(); i++) {
		  list.get(i).setBnum(bnum);
		  }
		boolean att = bookmap.addfile(bo.getFlist()) > 0;
	           if (!bSaved) {
	               return false;
		        }
		}
	   return bSaved;
	}
}
```
<div style = "font-size : 15px; margin-bottom: 15px">
1. 문의 사항 추가로직과 동일합니다.</div>


<div style="font-size : 17px; color:bule; margin-bottom: 7px">BookController</div>
```java
@Controller
@RequestMapping("/book")
@SessionAttributes("userid")
public class BookController {

	@Autowired
	@Qualifier("bookdao")
	private BookDAO dao;
	
	@Autowired
	  @Qualifier("fairydao")
	  private FairyDAO fairydao;
	
	@PostMapping("/add")
	   @ResponseBody
	       public Map<String, Object> addBook(@RequestParam("file") MultipartFile cvrimg,
	                                  	  @RequestParam("conimg") MultipartFile contentimg,
	                                  	  Book bo,HttpServletRequest request) 
	      {
	      Map<String, Object> map = new HashMap<>();
	      ServletContext context = request.getServletContext();
	      String savePath = context.getRealPath("/img");
	      List<Bookattach> filelist = new ArrayList<>();
	           try {
	                  String fileName = cvrimg.getOriginalFilename();
	                  cvrimg.transferTo(new File(savePath + "/" + fileName));
	                  String cType = cvrimg.getContentType();
	                  String pName = cvrimg.getName();
	                  Resource res = cvrimg.getResource();
	                  long fSize = cvrimg.getSize();
	                  bo.setCvrimg(fileName);
	                  bo.setFsize(fSize/1024);
	                  bo.setContenttype(cType);
	                  boolean empty = cvrimg.isEmpty();
	//---------------------------content-------------------------------------------------------------   
	//---------------------------content-------------------------------------------------------------   
	                 if(contentimg != null && !contentimg.isEmpty()) {
	                     String contentName = contentimg.getOriginalFilename();
		             contentimg.transferTo(new File(savePath + "/" + contentName));
		             String conType = contentimg.getContentType();
		             String conName = contentimg.getName();
  	                     Resource con = contentimg.getResource();
	                     long conSize = contentimg.getSize();
	                     boolean cont = contentimg.isEmpty();
		                  
		             Bookattach ba = new Bookattach();
		                  
		             ba.setContentimg(contentName);
		             ba.setConsize(conSize/1024);
		             ba.setContype(conType);
		             filelist.add(ba);
		                  
		             bo.setFlist(filelist);
		                 
		             boolean added = dao.addbooks(bo);
		             map.put("added", added);
	                  }else {
	                    boolean added = dao.addbooks(bo);
	                    map.put("added", added);
	                  }
	                } catch (Exception e) {
	                    e.printStackTrace();
	                }
	               return map;
	       }
}
```
<div style = "font-size : 15px; margin-bottom: 7px">
1. 책 추가시 메인 사진을 받고 추가로 상세페이지용 사진을 따로받기때문에 두번의 MultipartFile가 필요했습니다.</div>
<div style = "font-size : 15px; margin-bottom: 15px">
2. 상세페이지용 사진이 없을수도 있다는 가정하에 두가지 경우에도 로직이 문제없이 실행되게 만들었습니다.</div>

<div style="font-size : 17px; color:bule; margin-bottom: 7px">Addfrom.jsp</div>
```html
var bname = document.getElementById("bname").value;
   var publisher  = document.getElementById("publisher").value;
   var author = document.getElementById("author").value;
   var price  = document.getElementById("price").value;
   var pdate = document.getElementById("pdate").value;
   var cate = document.getElementById("content").value;
   var cate = document.getElementById("cate").value;

     if (bname == "") {
       alert("'책명' 입력은 필수입니다");
       return false;
     } else if (publisher == "") {
       alert("'출판사' 입력은 필수입니다");
       return false;
     }else if (author == "") {
      alert("'저자' 입력은 필수입니다");
       return false;
     } else if (price == "") {
       alert("'가격' 입력은 필수입니다");
       return false;
       } else if (pdate == "") {
       alert("'출판일' 입력은 필수입니다");
       return false;
       } else if (content == "") {
      alert("'줄거리' 입력은 필수입니다");
      return false;
     } else if (cate == "") {
       alert("'카테고리' 입력은 필수입니다");
       return false;
       } 
   
   if (!confirm("책을 추가할까요?")) {
       return false;
   }
   $('#btnUpload').prop('disabled', true);
   var form = $('#addform')[0];
    var formData = new FormData(form);
   $.ajax({
      url:'/book/add',
       data: formData,
       enctype: 'multipart/form-data',
         method: 'post',
         cache: false,
         dataType: 'json',
         processData: false,
         contentType: false,
         timeout: 3600,
      success:function(res) {
         alert(res.added ? '저장 성공':' 저장 실패');
         if(res.added) location.href='/book/list/page/1';
      },
      error:function(xhr,status,err) {
         alert('에러:' + err);
          $('#btnUpload').prop('disabled', false);
      }
   });
   return false;
}

function preview(evt) {
    var reader = new FileReader();

    reader.onload = function (event) {
        var thumbnailContainer = document.getElementById("thumbnail_view");
        thumbnailContainer.innerHTML = "";

        var img = document.createElement("img");
        img.src = event.target.result;
        thumbnailContainer.appendChild(img);
    };

    reader.readAsDataURL(evt.target.files[0]);
}
```
<div style = "font-size : 15px; margin-bottom: 15px">
1. 책추가시 꼭필요한 요소가 들어가지 않으면 alert를 이용해 추가를 못하게 만들었습니다.
<img src="/assets/images/king.png" width="200px" height="600px" title="px(픽셀) 크기 설정" alt="RubberDuck"/>
2. 모든 입력란에 입력후 확인을 누르면 '저장성공'창이 뜹니다.
<img src="/assets/images/king1.png" width="400px" height="250px" title="px(픽셀) 크기 설정" alt="RubberDuck"/>
</div>
----------------------------------------------------
- 목록기능

<div style="font-size : 17px; color:bule; margin-bottom: 7px">BookMapper.xml</div>
```html
<!--책 추가 로직입니다 -->
<select id="getallbook" resultType="map">
   SELECT * FROM book
</select>

<select id="search" parameterType="com.ezen.spring.board.teampro.book.Book"
   resultType="com.ezen.spring.board.teampro.book.Book">
   SELECT * FROM book
   WHERE
   <choose>
	<when test="bname != null">
		bname LIKE CONCAT('%', #{bname}, '%')
	</when>
	<when test="publisher != null">
		publisher = #{publisher}
	</when>
	<when test="author != null">
		author = #{author}
	</when>	
    </choose>
</select>

<select id="CateSearch" parameterType="String"
   resultType="com.ezen.spring.board.teampro.book.Book">
   SELECT * FROM book
   WHERE cate = #{cate}
</select>

<select id="best" resultType="com.ezen.spring.board.teampro.book.Book" parameterType="String">
SELECT bb.bnum, b.bname, b.price, b.cvrimg, SUM(bb.quantity) AS total_quantity
FROM test.boughtbook bb
JOIN test.book b ON bb.bnum = b.bnum
GROUP BY bb.bnum, b.bname, b.price, b.cvrimg
ORDER BY total_quantity DESC
LIMIT 3;
</select>
```
<div style = "font-size : 15px; margin-bottom: 7px">
1. 목록 기능에는 이용자가 검색기능과 카테고리별로 찾을수 있는 로직이 필요합니다. 총 3개의 SQL문이 사용 되었습니다.</div>

<div style = "font-size : 15px; margin-bottom: 7px">
2. bname은 제목인데 제목의 일부분만 입력해도 그 단어가 포함된 모든 책을 불러옵니다.</div>

<div style = "font-size : 15px; margin-bottom: 15px">
3. Best는 베스트 셀러기능을 위해 sql문을 만들었습니다.</div><br>

<div style="font-size : 17px; color:bule; margin-bottom: 7px">BookDAO</div>
```java
public class BookDAO {

	
	@Autowired
	@Qualifier("bookmapper")
	private BookMapper bookmap;
	
	public PageInfo<Map> getallbook(int pageNum) {
		PageHelper.startPage(pageNum,10);
		PageInfo<Map> pageInfo = new PageInfo<> (bookmap.getallbook());
		
		return pageInfo;
	}
	
	public PageInfo<Map> search(String category,String keyword, int pageNum)
	{
		PageHelper.startPage(pageNum,10);
		Book vo = new Book();
		if(category.equals("bname")) {vo.setBname(keyword);}
		else if(category.equals("publisher")) {vo.setPublisher(keyword);}
		else if(category.equals("author")) {vo.setAuthor(keyword);}
		
		PageInfo<Map> pageInfo = new PageInfo<>(bookmap.search(vo));
		
		
		return pageInfo;
		
	}
	public List<Book> catesearch(String cate)
	{
		List<Book> vo = bookmap.CateSearch(cate);
		return vo;
	}
}
```
<div style = "font-size : 15px; margin-bottom: 15px">
1. pageinfo기능을 사용하여 목록을 만들어 봤습니다. </div>

<div style="font-size : 17px; color:bule; margin-bottom: 7px">BookController</div>
```java
@Controller
@RequestMapping("/book")
@SessionAttributes("userid")
public class BookController {

	@Autowired
	@Qualifier("bookdao")
	private BookDAO dao;
	
	@Autowired
	  @Qualifier("fairydao")
	  private FairyDAO fairydao;
	
	@GetMapping("/list/page/{pn}")
	public String getlist(@PathVariable int pn,
	        	      @RequestParam(value="category", required=false) String category,
	         	      @RequestParam(value="keyword", required=false) String keyword, Model model,
	         	      @SessionAttribute(name = "userid", required = false)String userid)
	   {
	    List<CarrotVO> clist = new ArrayList<>();
	    List<Book> list = new ArrayList<>();

  	    clist = fairydao.carrot(userid);

  	    model.addAttribute("users",clist);
	    model.addAttribute("rest",dao.getmember(userid));

	    PageInfo<Map> pageInfo = null;
	    if(category !=null){
	         pageInfo = dao.search(category, keyword, pn);
	         model.addAttribute("category" , category);
	         model.addAttribute("keyword", keyword);
	      }else {
	         pageInfo = dao.getallbook(pn);
	      }
	    list = dao.best();
	    model.addAttribute("user",dao.getmember(userid));
	    model.addAttribute("best",list);
	    model.addAttribute("pageInfo",pageInfo);
	      
	    return "book/list";  
	   }
	
	@PostMapping("/search")
	public String search(@RequestParam("category") String category,
			     @RequestParam("keyword") String keyword, Model model)
	{
	  PageInfo<Map> pageInfo = dao.search(category, keyword,1);
	  model.addAttribute("pageInfo", pageInfo);
	  model.addAttribute("category", category);
	  model.addAttribute("keyword", keyword);
		
	  return "book/list";	
	}
	
	@GetMapping("/listcate/{cate}")
	public String catelist(@PathVariable String cate,Model model)
	{
	  List<Book> vo = dao.catesearch(cate);
	  model.addAttribute("cate",vo);
	  return "book/catelist"; 
	}
}
```
<div style = "font-size : 15px; margin-bottom: 15px">
1. dao.getmember은 목록페이지에 유저의 정보가 출력되기 때문에 책과 관련이 없지만 로직에 추가했습니다.</div>


<div style="font-size : 17px; color:bule; margin-bottom: 7px">list.jsp</div>
```html
<h3> fairy book's </h3>

   <div class="container">
      <ul class="tabs">
            <li class="tab-link current" data-tab="tab-1">로그인 </li>
            <li class="tab-link" data-tab="tab-2">상품 카테고리</li>
            <li class="tab-link" data-tab="tab-3">문의</li>
         </ul>
      <div id="tab-1" class="tab-content current">
         
      <h2>
      <c:choose>
         <c:when test="${sessionScope.isAdmin eq 9}">
           관리자님 어서오세요^^
         </c:when>
     
         <c:when test="${sessionScope.userid eq null}">
      	   어서오세요 fairy's book 입니다
         </c:when>
      
         <c:otherwise>
           ${user.name}님 어서오세요 ^^
         </c:otherwise>
      </c:choose>
      </h2>
      <c:choose>
   	<c:when test="${empty sessionScope.userid}">
      	  [<a href="/fairy/login">로그인</a>]
      	  [<a href="/fairy/joinForm">회원가입</a>]
  	</c:when>
   	<!-- number 9라면 관리자가 보는 창-->
   	<c:when test="${user.number eq 9}">
   	  [<a href="javascript:admin();">관리자페이지</a>]
   	  [<a href="/fairy/cart/buylist/${userid}"> 구매목록 </a>]
     	  [<a href="/carrot/list/page/1">당근마켓</a>]
    	  [<a href="/fairy/cart/list">장바구니</a>]
   	  [<a href="/fairy/cart/buy">결제창</a>]
   	  [<a href="javascript:mypagego()">마이페이지</a>]
   	  [<a href="javascript:logout();">로그아웃</a>]
   	</c:when>
	<!-- 일반유저가 보는창-->
   	<c:otherwise>
      	  [<a href="/fairy/cart/buylist/${userid}"> 구매목록 </a>]
          [<a href="/carrot/list/page/1">당근마켓</a>]
      	  [<a href="/fairy/cart/list">장바구니</a>]
          [<a href="/fairy/cart/buy">결제창</a>]
          [<a href="javascript:mypagego()">마이페이지</a>]
          [<a href=javascript:logout();>로그아웃</a>]
   	</c:otherwise>
      </c:choose>
    </div>
      <div id="tab-2" class="tab-content">
         [<a href="/book/listcate/a"> 동물 </a>] [<a href="/book/listcate/b"> 공주 </a>][<a href="/book/listcate/c"> 사물 </a>]
      </div>
      <div id="tab-3" class="tab-content">
         <a href="/board/board/list/page/1" style="text-decoration:none;">[문의하기]</a>
      </div>
   
   </div>
```
<div style = "font-size : 15px; margin-bottom: 15px">
1. 관리자계정으로 로그인하면 관리자 페이지가 보이게 만들었습니다.
<img src="/assets/images/no.png" width="600px" height="200px" title="px(픽셀) 크기 설정" alt="RubberDuck"/>
<img src="/assets/images/user.png" width="600px" height="200px" title="px(픽셀) 크기 설정" alt="RubberDuck"/>
<img src="/assets/images/admin.png" width="600px" height="200px" title="px(픽셀) 크기 설정" alt="RubberDuck"/>
2. 상품 카테고리를 선택하면 3가지가 나오게 만들었습니다.
<img src="/assets/images/cate.png" width="600px" height="200px" title="px(픽셀) 크기 설정" alt="RubberDuck"/>
</div>

```html
<h1>이달의 베스트셀러</h1> 
   
      <c:forEach var="best" items="${best}">
      <div class="divss">
      <div>
         <a href="/book/book/${best.bnum}"><img src="/img/${best.cvrimg}" style="max-width: 100px; max-height: 100px;"></a>
      </div>
      <div>
         <a href="/book/book/${best.bnum}">${best.bname}</a>
      </div>
      <div>
         <fmt:formatNumber value="${best.price}"/>원
      </div>
      </div>
      </c:forEach>
	<div class="clear"></div>
<!--최근본 상품은 javascript를 이용해 만들었습니다. -->
<div class="floating-wrapper" >
    <div class="title">[최근본 상품]</div>
       <div id="cookieValueWrapper">
    
       </div>
    </div>

$(document).ready(function() {
     var storedValues = JSON.parse(localStorage.getItem("myValues")) || [];
     var $cookieValueWrapper = $("#cookieValueWrapper");
     $cookieValueWrapper.empty();
      
     console.log(storedValues);
     
     for (var i = storedValues.length - 1; i >= 0; i--) {
       var value = storedValues[i];
       var $itemWrapper = $("<div>").addClass("item");
       var $valueElement = $("<div>").text(value.bname);
       var $imageElement = $("<img>").attr("src", value.image);
       var $linkElement = $("<a>").attr("href","/book/book/"+value.bnum);
       

       $linkElement.append($valueElement);
       $linkElement.append($imageElement);
       $itemWrapper.append($linkElement);
       
       $cookieValueWrapper.append($itemWrapper);
```
<div style = "font-size : 15px; margin-bottom: 7px">
1. 베스트셀러와 최근본 상품기능을 만들었습니다.<br>
2. 베스트 셀러는 가장 많이 팔린책을 sql문으로 조회해 가져오고 웹 화면에 보여집니다.
<img src="/assets/images/new.png" width="600px" height="200px" title="px(픽셀) 크기 설정" alt="RubberDuck"/>
</div>
<div style = "font-size : 15px; margin-bottom: 15px">
3. 제목으로 일부분만 검색해도 해당 단어가 있는 게시물을 가져올수 있습니다.
<img src="/assets/images/k.png" width="600px" height="200px" title="px(픽셀) 크기 설정" alt="RubberDuck"/>
</div>
------------------------------------------------------------------

- DETAIL 페이지

<div style="font-size : 17px; color:bule; margin-bottom: 7px">BookMapper.xml</div>
```html
<!--책 상세정보를 가져옴 -->
<select id="getbook" resultType="java.util.Map" parameterType="Integer">
   SELECT b.*,a.contentimg
   FROM book b
   LEFT OUTER JOIN bookattach a ON b.bnum = a.bnum
   where b.bnum=#{bnum}
</select>

<!--책 상세보기에서 Q&A를 등록/보기 로직입니다. -->
<insert id ="qnaadd" parameterType="com.ezen.spring.board.teampro.book.QnAVO">
  INSERT INTO qna (qnum,userid,qcontent,qnadate) values(#{qnum},#{userid},#{qcontent}, CURRENT_TIMESTAMP)
</insert>
<select id="getqnalist" resultType="Map" parameterType="Integer">
   SELECT * FROM qna where qnum = #{qnum}
</select>
<!--책 상세보기에서 관리자용 답글Q&A를 등록/보기 로직입니다. -->
<insert id="qnacomment" parameterType="com.ezen.spring.board.teampro.book.Qnacomment">
INSERT INTO qnacomment (qnum,name,qcomment)
VALUE (#{qnum},#{name},#{qcomment})
</insert>

<select id="getallqnacomment" resultType="map">
SELECT * FROM qnacomment 
</select>

<!--책 상세보기에서 리뷰를 등록/보기 로직입니다. -->
<insert id="addreview" parameterType="com.ezen.spring.board.teampro.book.review">
INSERT INTO review (bnum,bname,userid,reviewcontents,score,rdate)
VALUE (#{bnum},#{bname},#{userid},#{reviewcontents},#{score},#{rdate})
</insert>

<select id="reviewlist" parameterType="Integer" resultType="map">
SELECT * FROM test.review WHERE bnum=#{bnum} ORDER BY count DESC
</select>
```
<div style = "font-size : 15px; margin-bottom: 7px">
1. 디테일화면에서는 리뷰,Q&A등의 기능을 사용 할 수 있습니다.</div>

<div style = "font-size : 15px; margin-bottom: 15px">
2. DAO는 중요한 기능이 없기에 추가하지 않겠습니다.</div>

<div style="font-size : 17px; color:bule; margin-bottom: 7px">BookController</div>
```java
public class BookController {

	@Autowired
	@Qualifier("bookdao")
	private BookDAO dao;
	
	@GetMapping("/book/{bnum}")//detail부분
	 public ModelAndView getbook(@PathVariable int bnum,Model model,
				    @SessionAttribute(name = "userid", required = false)String userid)
	{
		model.addAttribute("user",dao.getmember(userid));

		List<Map> blist = new ArrayList<>();
		blist = dao.getbook(bnum);

		List<Map> qnlist = new ArrayList<>();
		qnlist = dao.qnacomment(); //

		ModelAndView modelAndView = new ModelAndView("book/detail");

		 List<Map> qlist = new ArrayList<>();
		 qlist = dao.getqna1(bnum);

		 List<Map> list = dao.reviewlist(bnum);
         	// dao.reviewlist(bnum)가 null인 경우 빈 리스트로 초기화
         	model.addAttribute("review", list != null ? list : Collections.emptyList());
         
         	// 평점 가져오기, dao.score(bnum)가 null인 경우 기본값으로 0 설정
        	 Double score = dao.score(bnum);
         	model.addAttribute("score", score != null ? score : 0);
         	model.addAttribute("qnacom", qnlist);
		model.addAttribute("qnalist",qlist);
		model.addAttribute("book", blist);
		return modelAndView;
	}
	
	 @PostMapping("/book/review")
	 @ResponseBody
	  public Map<String,Boolean> addreview(@RequestBody review re){
	      boolean added = false;
	      Map<String, Boolean> map = new HashMap<>();

	      added=dao.addreview(re);
	      map.put("added", added);
	      return map;
	   }
	  
	  @PostMapping("addqna")
	  @ResponseBody
	   public Map<String,Boolean> addqna(QnAVO vo){
			Map<String,Boolean> map = new HashMap<>();
			boolean qna = dao.addqna(vo);
			map.put("qna", qna);
			
			return map;
		}

	   @PostMapping("/qnacomment")
	   @ResponseBody
	    public Map<String, Boolean> qnacomment(Qnacomment Qna){
			Map<String, Boolean> map = new HashMap<>();
			map.put("qnacomment", dao.Qnacomment(Qna));

			return map;
		}

}
```
<div style = "font-size : 15px; margin-bottom: 15px">
1. 상세페이지에 리뷰와 Q&A가 보여집니다.</div>

<div style="font-size : 17px; color:bule; margin-bottom: 7px">detail.jsp</div>
```html
<!--리뷰 출력 로직-->
<div class="recent-review">
    <c:choose>
        <c:when test="${empty review}">
            <p>아직 등록된 리뷰가 없습니다.</p>
        </c:when>
        <c:otherwise>
            <c:forEach var="re" items="${review}" begin="0" end="1">
                <div class="review-item">
                    <label>아이디: </label>
                    <input type="text" class="userid" name="userid" value="${re.userid}" readonly>
                    <label>평점: </label>
                    <input type="text" class="score" name="score" value="${re.score}" readonly>
                </div>
                <label>사용평: </label>
                <div class="review-content" cols="54" rows="10" readonly>${re.reviewcontents}</div>
            </c:forEach>
        </c:otherwise>
    </c:choose>
</div>

<div class="review-summary">
    <h4>평점은 5점 만점입니다.</h4>
    <a href="/book/book/reviewlist/${book[0].bnum}/1">
        <button type="button">전체 리뷰 보기</button>
    </a>
    <h4>평균 평점: ${score}</h4>
</div>

<hr>
<!-- 리뷰작성 로직 -->
<c:choose>
    <c:when test="${empty sessionScope.userid}">
        <!-- Display login or registration message if the user is not logged in -->
        <p>리뷰를 작성하려면 로그인이 필요합니다.</p>
        <p>로그인 또는 회원가입을 해주세요.</p>
    </c:when>
    <c:otherwise>
        <h4>리뷰 작성</h4>
        <form id="rev" onsubmit="return addreview()">
            <div class="review-form">
                <input type="hidden" id="bnum" name="bnum" value="${book[0].bnum}">
                <input type="hidden" id="bname" name="bname" value="${book[0].bname}">
                <input type="hidden" id="userid" name="userid" value="${sessionScope.userid}">

                <label>평점: </label>
                <select id="score" name="score">
                    <option value="">평점 선택</option>
                    <option value="1">1</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5</option>
                </select>
            </div>
            <label>사용평: </label>
            <textarea class="review-contents" cols="80" rows="10" id="reviewcontents" name="reviewcontents" ></textarea>
            <input type="submit">
        </form>
    </c:otherwise>
</c:choose>
```
<div style = "font-size : 15px; margin-bottom: 15px">
1. 기본적인 리뷰의 출력과 추가 로직입니다.<br>
<img src="/assets/images/detail.png" width="600px" height="200px" title="px(픽셀) 크기 설정" alt="RubberDuck"/>
<img src="/assets/images/detail1.png" width="600px" height="200px" title="px(픽셀) 크기 설정" alt="RubberDuck"/>
</div><br>

```html
<div style="text-align: center; font-size: 30px;"><a id="qnaToggle" href="javascript:void(0);" >Q&A</a></div><hr>

<form id = "QnA" style="display: none;">
        <c:forEach var="qna" items="${qnalist}">

       <table id = "tr_qna" style="width: 500px; margin: 0 auto;">
       <input type="hidden" id="qnum" name="qnum" value="${qna.qnum}">
  <tr >
    <th>${qna.userid}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;${qna.qcontent}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;${qna.qnadate}</th>
  </tr>
 <c:forEach var="qnacom" items="${qnacom}">
 <c:if test="${qna.num == qnacom.qnum}">
      <tr>
      <td>${qnacom.name}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
      	  ${qnacom.qcomment}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
      	  ${qnacom.comdate}</td> 
	  </tr>
	  </c:if>
 </c:forEach>
 
  <c:if test="${user.number == 9}">
      <div>  
      <form class="comment-form" >
	    <input type="hidden" id="qnum" name="qnum" value="${qna.num}">
	    <div>
	      <input type="text" id="qcomment" name="qcomment" style="width: 500px; padding: 8px;">
	      <button type="button" onclick="qnacomment(${qna.num})">등록</button>
	    </div>
	  </form>
	  </div>
	  </c:if>
</table>

        </c:forEach>
  <br>
  
	<form id = "QnAadd">
	<c:if test="${user.number == 0}">
	<input type="hidden" id="userid" name ="userid" value="${sessionScope.userid}">
	<input type="text" id="qcontent" name ="qcontent" style="width: 500px; padding: 8px;">
	<button type="button" onclick="javascript:qnaadd()">등록</button>
	</c:if>
	</form>
</form>
<!-- Q&A 클릭시 none가 해체됨 -->
$(document).ready(function() {
    $('#qnaToggle').click(function() {
        console.log("Q&A 테이블 토글");
        $('#QnA').toggle(); // #QnA 테이블의 표시/감춤을 토글
    });
});
```
<div style = "font-size : 15px; margin-bottom: 15px">
1. Q&A는 평소에는 보이지 않지만 클릭시 보이게 만들었습니다.<br>
<img src="/assets/images/qna.png" width="600px" height="200px" title="px(픽셀) 크기 설정" alt="RubberDuck"/>
</div>
--------------------------------------------------------------------------
- 수정기능

<div style="font-size : 17px; color:bule; margin-bottom: 7px">BookMapper.xml</div>
```html
<update id="updateBook" parameterType="com.ezen.spring.board.teampro.book.Book">
    UPDATE test.book
    SET bname = #{bname},
        publisher = #{publisher},
        author = #{author},
        price = #{price},
        content = #{content}
    WHERE bnum = #{bnum}
</update>

<update id="updateattach" parameterType="com.ezen.spring.board.teampro.book.Bookattach">
    UPDATE test.bookattach
    SET contentimg = #{contentimg},
        consize = #{consize},
        contype = #{contype}
    WHERE bnum = #{bnum}
</update>
```
<div style = "font-size : 15px; margin-bottom: 7px">
1. 두개의 insert문이 있듯 update문도 2개가 있습니다..</div>

<div style="font-size : 17px; color:bule; margin-bottom: 7px">BookDAO</div>
```java
public class BookDAO {
	@Autowired
	@Qualifier("bookmapper")
	private BookMapper bookmap;
	
	public boolean updateBook(Book b)
	{
	    boolean bSaved = bookmap.updateBook(b)>0;
		
	    int bnum = b.getBnum();
	    List<Bookattach> list = b.getFlist();
	    if (list != null && !list.isEmpty()) {
		 list.get(0).setBnum(bnum);
		 boolean att =  bookmap.addfile(b.getFlist()) > 0;
		    if (!bSaved) {
		        return false;
		        }
		}
	    return bSaved;	   
	}

}
```
<div style = "font-size : 15px; margin-bottom: 15px">
2. 추가기능과 로직은 유사합니다..</div>

<div style="font-size : 17px; color:bule; margin-bottom: 7px">BookController</div>
```java
public class BookController {
	@Autowired
	@Qualifier("bookdao")
	private BookDAO dao;

	@PostMapping("/update")
	   @ResponseBody
	   public Map<String,Boolean> update(
	                             @RequestParam("conimg") MultipartFile contentimg,
	                             Book bo,HttpServletRequest request)
	   {
	      Map<String,Boolean> map = new HashMap<>();
	      ServletContext context = request.getServletContext();
	       String savePath = context.getRealPath("/img");
	       List<Bookattach> filelist = new ArrayList<>();
	       try {
	          if(contentimg != null && !contentimg.isEmpty()) {
	               String contentName = contentimg.getOriginalFilename();
	                 contentimg.transferTo(new File(savePath + "/" + contentName));
	                 String conType = contentimg.getContentType();
	                 String conName = contentimg.getName();
	                 Resource con = contentimg.getResource();
	                 long conSize = contentimg.getSize();
	                 boolean cont = contentimg.isEmpty();
	                 
	                 Bookattach ba = new Bookattach();
	                 
	                 ba.setContentimg(contentName);
	                 ba.setConsize(conSize/1024);
	                 ba.setContype(conType);
	                 filelist.add(ba);
	                 
	                 bo.setFlist(filelist);
	                
	                 boolean success = dao.updateBook(bo);
	              map.put("update", success);
	            }else {
	               boolean success = dao.updateBook(bo);
	             map.put("update", success);
	            }
	       } catch (Exception e) {
	         e.printStackTrace();
	       }   
	         return map;
	   }

}
```
<div style = "font-size : 15px; margin-bottom: 15px">
1. 메인사진은 수정이 불가능 하지만 상세보기의 사진은 수정이 가능하게 만들었습니다.</div>

<div style="font-size : 17px; color:bule; margin-bottom: 7px">updateform.jsp</div>

<div style = "font-size : 15px; margin-bottom: 7px">
1. jsp코드는 추가기능과 유사하기 때문에 첨부하지 않았습니다.<br>
<img src="/assets/images/update.png" width="600px" height="200px" title="px(픽셀) 크기 설정" alt="RubberDuck"/>
</div>
<div style = "font-size : 15px; margin-bottom: 15px">
2. 수정 완료가 정상적으로 뜨는걸 확인했습니다.
</div><br>

-삭제기능

<div style="font-size : 17px; color:bule; margin-bottom: 7px">BookMapper.xml</div>
```html
<!--책 상세정보를 가져옴 -->
<select id="getbook" resultType="java.util.Map" parameterType="Integer">
   SELECT b.*,a.contentimg
   FROM book b
   LEFT OUTER JOIN bookattach a ON b.bnum = a.bnum
   where b.bnum=#{bnum}
</select>

<!--책 상세보기에서 Q&A를 등록/보기 로직입니다. -->
<insert id ="qnaadd" parameterType="com.ezen.spring.board.teampro.book.QnAVO">
  INSERT INTO qna (qnum,userid,qcontent,qnadate) values(#{qnum},#{userid},#{qcontent}, CURRENT_TIMESTAMP)
</insert>
<select id="getqnalist" resultType="Map" parameterType="Integer">
   SELECT * FROM qna where qnum = #{qnum}
</select>
<!--책 상세보기에서 관리자용 답글Q&A를 등록/보기 로직입니다. -->
<insert id="qnacomment" parameterType="com.ezen.spring.board.teampro.book.Qnacomment">
INSERT INTO qnacomment (qnum,name,qcomment)
VALUE (#{qnum},#{name},#{qcomment})
</insert>

<select id="getallqnacomment" resultType="map">
SELECT * FROM qnacomment 
</select>

<!--책 상세보기에서 리뷰를 등록/보기 로직입니다. -->
<insert id="addreview" parameterType="com.ezen.spring.board.teampro.book.review">
INSERT INTO review (bnum,bname,userid,reviewcontents,score,rdate)
VALUE (#{bnum},#{bname},#{userid},#{reviewcontents},#{score},#{rdate})
</insert>

<select id="reviewlist" parameterType="Integer" resultType="map">
SELECT * FROM test.review WHERE bnum=#{bnum} ORDER BY count DESC
</select>
```
<div style = "font-size : 15px; margin-bottom: 7px">
1. 디테일화면에서는 리뷰,Q&A등의 기능을 사용 할 수 있습니다.</div>

<div style = "font-size : 15px; margin-bottom: 15px">
2. DAO는 중요한 기능이 없기에 추가하지 않겠습니다.</div>

<div style="font-size : 17px; color:bule; margin-bottom: 7px">BookController</div>
```java
public class BookController {

	@Autowired
	@Qualifier("bookdao")
	private BookDAO dao;
	
	@GetMapping("/book/{bnum}")//detail부분
	 public ModelAndView getbook(@PathVariable int bnum,Model model,
				    @SessionAttribute(name = "userid", required = false)String userid)
	{
		model.addAttribute("user",dao.getmember(userid));

		List<Map> blist = new ArrayList<>();
		blist = dao.getbook(bnum);

		List<Map> qnlist = new ArrayList<>();
		qnlist = dao.qnacomment(); //

		ModelAndView modelAndView = new ModelAndView("book/detail");

		 List<Map> qlist = new ArrayList<>();
		 qlist = dao.getqna1(bnum);

		 List<Map> list = dao.reviewlist(bnum);
         	// dao.reviewlist(bnum)가 null인 경우 빈 리스트로 초기화
         	model.addAttribute("review", list != null ? list : Collections.emptyList());
         
         	// 평점 가져오기, dao.score(bnum)가 null인 경우 기본값으로 0 설정
        	 Double score = dao.score(bnum);
         	model.addAttribute("score", score != null ? score : 0);
         	model.addAttribute("qnacom", qnlist);
		model.addAttribute("qnalist",qlist);
		model.addAttribute("book", blist);
		return modelAndView;
	}
	
	 @PostMapping("/book/review")
	 @ResponseBody
	  public Map<String,Boolean> addreview(@RequestBody review re){
	      boolean added = false;
	      Map<String, Boolean> map = new HashMap<>();

	      added=dao.addreview(re);
	      map.put("added", added);
	      return map;
	   }
	  
	  @PostMapping("addqna")
	  @ResponseBody
	   public Map<String,Boolean> addqna(QnAVO vo){
			Map<String,Boolean> map = new HashMap<>();
			boolean qna = dao.addqna(vo);
			map.put("qna", qna);
			
			return map;
		}

	   @PostMapping("/qnacomment")
	   @ResponseBody
	    public Map<String, Boolean> qnacomment(Qnacomment Qna){
			Map<String, Boolean> map = new HashMap<>();
			map.put("qnacomment", dao.Qnacomment(Qna));

			return map;
		}

}
```
<div style = "font-size : 15px; margin-bottom: 15px">
1. 상세페이지에 리뷰와 Q&A가 보여집니다.</div>

<div style="font-size : 17px; color:bule; margin-bottom: 7px">detail.jsp</div>
```html
<!--리뷰 출력 로직-->
<div class="recent-review">
    <c:choose>
        <c:when test="${empty review}">
            <p>아직 등록된 리뷰가 없습니다.</p>
        </c:when>
        <c:otherwise>
            <c:forEach var="re" items="${review}" begin="0" end="1">
                <div class="review-item">
                    <label>아이디: </label>
                    <input type="text" class="userid" name="userid" value="${re.userid}" readonly>
                    <label>평점: </label>
                    <input type="text" class="score" name="score" value="${re.score}" readonly>
                </div>
                <label>사용평: </label>
                <div class="review-content" cols="54" rows="10" readonly>${re.reviewcontents}</div>
            </c:forEach>
        </c:otherwise>
    </c:choose>
</div>

<div class="review-summary">
    <h4>평점은 5점 만점입니다.</h4>
    <a href="/book/book/reviewlist/${book[0].bnum}/1">
        <button type="button">전체 리뷰 보기</button>
    </a>
    <h4>평균 평점: ${score}</h4>
</div>

<hr>
<!-- 리뷰작성 로직 -->
<c:choose>
    <c:when test="${empty sessionScope.userid}">
        <!-- Display login or registration message if the user is not logged in -->
        <p>리뷰를 작성하려면 로그인이 필요합니다.</p>
        <p>로그인 또는 회원가입을 해주세요.</p>
    </c:when>
    <c:otherwise>
        <h4>리뷰 작성</h4>
        <form id="rev" onsubmit="return addreview()">
            <div class="review-form">
                <input type="hidden" id="bnum" name="bnum" value="${book[0].bnum}">
                <input type="hidden" id="bname" name="bname" value="${book[0].bname}">
                <input type="hidden" id="userid" name="userid" value="${sessionScope.userid}">

                <label>평점: </label>
                <select id="score" name="score">
                    <option value="">평점 선택</option>
                    <option value="1">1</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5</option>
                </select>
            </div>
            <label>사용평: </label>
            <textarea class="review-contents" cols="80" rows="10" id="reviewcontents" name="reviewcontents" ></textarea>
            <input type="submit">
        </form>
    </c:otherwise>
</c:choose>
```
<div style = "font-size : 15px; margin-bottom: 15px">
1. 기본적인 리뷰의 출력과 추가 로직입니다.<br>
<img src="/assets/images/detail.png" width="600px" height="200px" title="px(픽셀) 크기 설정" alt="RubberDuck"/>
<img src="/assets/images/detail1.png" width="600px" height="200px" title="px(픽셀) 크기 설정" alt="RubberDuck"/>
</div><br>

```html
<div style="text-align: center; font-size: 30px;"><a id="qnaToggle" href="javascript:void(0);" >Q&A</a></div><hr>

<form id = "QnA" style="display: none;">
        <c:forEach var="qna" items="${qnalist}">

       <table id = "tr_qna" style="width: 500px; margin: 0 auto;">
       <input type="hidden" id="qnum" name="qnum" value="${qna.qnum}">
  <tr >
    <th>${qna.userid}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;${qna.qcontent}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;${qna.qnadate}</th>
  </tr>
 <c:forEach var="qnacom" items="${qnacom}">
 <c:if test="${qna.num == qnacom.qnum}">
      <tr>
      <td>${qnacom.name}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
      	  ${qnacom.qcomment}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
      	  ${qnacom.comdate}</td> 
	  </tr>
	  </c:if>
 </c:forEach>
 
  <c:if test="${user.number == 9}">
      <div>  
      <form class="comment-form" >
	    <input type="hidden" id="qnum" name="qnum" value="${qna.num}">
	    <div>
	      <input type="text" id="qcomment" name="qcomment" style="width: 500px; padding: 8px;">
	      <button type="button" onclick="qnacomment(${qna.num})">등록</button>
	    </div>
	  </form>
	  </div>
	  </c:if>
</table>

        </c:forEach>
  <br>
  
	<form id = "QnAadd">
	<c:if test="${user.number == 0}">
	<input type="hidden" id="userid" name ="userid" value="${sessionScope.userid}">
	<input type="text" id="qcontent" name ="qcontent" style="width: 500px; padding: 8px;">
	<button type="button" onclick="javascript:qnaadd()">등록</button>
	</c:if>
	</form>
</form>
<!-- Q&A 클릭시 none가 해체됨 -->
$(document).ready(function() {
    $('#qnaToggle').click(function() {
        console.log("Q&A 테이블 토글");
        $('#QnA').toggle(); // #QnA 테이블의 표시/감춤을 토글
    });
});
```
<div style = "font-size : 15px; margin-bottom: 15px">
1. Q&A는 평소에는 보이지 않지만 클릭시 보이게 만들었습니다.<br>
<img src="/assets/images/qna.png" width="600px" height="200px" title="px(픽셀) 크기 설정" alt="RubberDuck"/>
</div>
--------------------------------------------------------------------------
- 삭제기능

<div style="font-size : 17px; color:bule; margin-bottom: 7px">BookMapper.xml</div>
```html
<!-- 전체 삭제 SQL문 -->
<delete id="getdelete" parameterType="Integer" >
DELETE FROM test.book WHERE bnum = #{bnum}
</delete>

<delete id="getattdelete" parameterType="Integer" >
DELETE FROM test.bookattach WHERE bnum = #{bnum}
</delete>
```
<div style = "font-size : 15px; margin-bottom: 7px">
1. 책  추가시 DB테이블이 2개라서 모두 실행해야 합니다</div>

<div style="font-size : 17px; color:bule; margin-bottom: 7px">BookDAO</div>
```java
public class BookDAO {
	@Autowired
	@Qualifier("bookmapper")
	private BookMapper bookmap;
	
	//전체삭제 로직
	public boolean deletebook(int bnum,String contentimg) {
		boolean bookatt = false;
		if(!contentimg.isEmpty()) {
		    bookatt = bookmap.getattdelete(bnum)>0;
		  }
		boolean book = bookmap.getdelete(bnum)>0;
		return book;
	}
	
	//수정시 상세설명에 사진만 삭제시 사용
	public boolean deleteatt(int bnum,String contentimg) {
		boolean bookatt = bookmap.getattdelete(bnum)>0;
		return bookatt;
	}
}
```
<div style = "font-size : 15px; margin-bottom: 7px">
1. 전체삭제를 할수도 있고 수정시 사진만 삭제가 가능하게 두가지 로직을 만들었습니다.</div>
<div style = "font-size : 15px; margin-bottom: 7px">
2. 자식테이블을 먼저 삭제해야 하기 때문에 attach테이블을 먼저 지워줍니다.</div>

<div style="font-size : 17px; color:bule; margin-bottom: 7px">BookController</div>
```java
public class BookController {
	@Autowired
	@Qualifier("bookdao")
	private BookDAO dao;

	@PostMapping("/delete/{bnum}")
	@ResponseBody
	public Map<String,Boolean> getdeletebook(@PathVariable int bnum,@RequestParam String cvrimg, 
						 @RequestParam String contentimg){
		Map<String,Boolean> map = new HashMap<>();
		boolean del = false;
				try
		Path thepath = Paths.get("/img" +"/" + cvrimg);
        	del = dao.deletebook(bnum,contentimg);
        	if(del==true) {
         {
	        		if (Files.exists(thepath)) {
	            		    Files.delete(thepath);
	        		    }
	        	    }catch (Exception e) {
			        TODO: handle exception
			    }
       		     }
		map.put("deleted", del);
		
		return map;
	}

	@PostMapping("/attremove")
	@ResponseBody
	public Map<String, Boolean> remove(@RequestParam("bnum")int bnum,
					   @RequestParam("contentimg")String contentimg)
		{
			Map<String, Boolean> map = new HashMap<>();
			map.put("attremove", dao.deleteatt(bnum,contentimg));

			return map;
		}

}
```
<div style = "font-size : 15px; margin-bottom: 15px">
1. 전체 삭제로직이 시작된다면 컴퓨터내 저장되어 있는 사진도 함께 삭제가 됩니다.</div>

<div style="font-size : 17px; color:bule; margin-bottom: 7px">Delete.jsp</div>
```html
<!-- 전체 삭제 로직 -->
function deleted(bnum)
{	
    var cvrimg;
    $('#cvrimg').each(function() {
        cvrimg = $(this).val();
    });
	  
    var contentimg;
    $('#contentimg').each(function() {
        contentimg = $(this).val(); 
    });

    var obj = {};
	obj.bnum = bnum;
	obj.cvrimg = cvrimg;
	obj.contentimg = contentimg;
	
    if(!confirm("책을 삭제합니까?")){
       return false;
       }
 
    $.ajax({
   	    url:'/admin/delete/'+bnum,
	    method:'post',
	    data: obj,
	    cache:false,
	    dataType:'json',
	    success:function(res) {
		alert(res.deleted ? '삭제완료':'삭제실패');
		location.reload();
		},
	    error:function(xhr,status,err){
		alert(status + "/" + err);
		}
	   });
	
}

<c:if test="${book.bnum != bnum}">
	<input type="hidden" id="cvrimg" name ="cvrimg" value="${book.cvrimg}">		
         <tr>
             <td>${book.bnum}</td>
             <td>${book.bname}</td>
             <td>${book.author}</td>
             <td>${book.publisher}</td>
             <td><fmt:formatNumber value="${book.price}"/>원</td>
             <td><img src="/img/${book.cvrimg}" style="max-width: 100px; max-height: 100px;"></td>
             <td>
                <button type = "button" onclick='updateform(${book.bnum});'>수정</button>
                <button type = "button" onclick="deleted(${book.bnum});">삭제</button>
             </td>
         </tr>
</c:if>

<!-- 상세글 사진만 삭제 로직 -->
function attremove(bnum,contentimg){
	if (!confirm("파일을 삭제겠습니까?")) {
	    return false;
	}
	var obj = {};
	obj.bnum = bnum;
	alert(bnum);
	obj.contentimg = contentimg;
	alert(contentimg);

	$.ajax({
	    url: '/book/attremove',// URL에 변수 값을 추가합니다.
	    data:obj,
	    method: 'post',
	    cache: false,
	    dataType: 'json',  // dataType을 'html'로 변경
	    success: function(res) {
	    	var message = res.attremove ? "삭제 성공" : "삭제 실패";
	        alert(message);
	        	location.reload();
	        
	    },
	    error: function(err) {
	        alert('에러: ' + err);
	    }
	});
}

<c:if test="${book[0].contentimg != null}">
            <img src="/img/${book[0].contentimg}" alt="이미지 미리보기" style="max-width: 200px; max-height: 200px;">
            </c:if>
            <a href="javascript:attremove('${book[0].bnum}','${book[0].contentimg}');" title="첨부파일 삭제">
				<c:if test="${not empty book[0].contentimg}">[X] <br>
				</c:if>
			</a>
```

<div style = "font-size : 15px; margin-bottom: 7px">
1. 관리자만 볼수있는 책 목록창에서 수정과 삭제가 가능한 로직이 있습니다.<br>
<img src="/assets/images/deli.png" width="600px" height="200px" title="px(픽셀) 크기 설정" alt="RubberDuck"/>
</div>
<div style = "font-size : 15px; margin-bottom: 15px">
2. 수정창 내에서 X표시를 누르면 정상적으로 삭제가 됩니다.
<img src="/assets/images/dele.png" width="600px" height="200px" title="px(픽셀) 크기 설정" alt="RubberDuck"/>
</div>
</div><br>
-----------------------------------------------------------------------------
<h3>개발 환경</h3>
<div style = "font-size : 15px; margin-bottom: 10px;"><span style="font-weight: bold;">언어</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:gray">Java(JDK17), HTML/CSS/JSP, JavaScript, Python</span></div>

<div style = "font-size : 15px; margin-bottom: 10px;"><span style="font-weight: bold;">서버</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:gray">Apache Tomcat10.1</span></div>

<div style = "font-size : 15px; margin-bottom: 10px;"><span style="font-weight: bold;">프레임워크</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:gray">Spring Boot,MyBatis</span></div>

<div style = "font-size : 15px; margin-bottom: 10px;"><span style="font-weight: bold;">DB</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:gray">MySQL8.0</span></div>

<div style = "font-size : 15px; margin-bottom: 10px;"><span style="font-weight: bold;">IDE</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:gray">Eclipse</span></div>

<div style ="margin-bottom: 10px; font-size : 15px; "><span style="font-weight: bold;">API, 라이브러리</span>&nbsp;&nbsp;<span style="color:gray;">Jquery, Maven</span></div>
